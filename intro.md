# Macro-CityFlow
---
## 1.现状
### 1）智慧城市的建设中对城市路网的研究是重要的一环，而如今强化学习等机器学习方法已经被广泛使用。
### 2）强化学习依赖于大量数据然而交通车流数据稀少而难以获取。为此开源软件CityFlow提供了交通数据仿真但是泛化性差，虽然可以在较大规模上运行但在超过1000个路口时还是慢。

## 2.解决方法
### 1）完善道路导入流程 能从现实地图中导入

### 2）分布式（暂时以并行方式体现）
#### 1拆解单个engine，减轻单个engine内部道路结算负担 顺便讲解结算流程以及同步模式（这个东西其实是唯一我们完全自己写的）。

## 3.困难和解决方法
### 1）引出workload balance，既然是同步结构就要balance，不能让单个engine承担过大量工作，为此我们阅读论文寻找多种解决方案，包括k-means等。然后发现这个问题非常贴合graph partition于是对问题进行松弛并找到了metis，用multilevel graph partition做切割保证平衡的同时减少engine之间沟通。
### 2）用数据结构解决瓶颈（虽然不算啥高级的数据结构但是要说），其实就是拿空间换时间。具体内容就是原本车辆在换engine的时候要重新结算路线，但这个过程非常缓慢，所以我们查找了瓶颈并发现路径查找中涉及一个很大可以被剪枝的查找，我们把存储方式改变了一下，时间减少到了原本的1/5。

## 3.实验结果展示
### timeline
### 实现了多少多少红绿灯，多少多少路长和intersection并发仿真，与vissim和一众宏观仿真软件比起来多厉害，同时还兼顾了微观上的真实性。
### 南京和九龙湖的图和NYC的图
### 10*10的视频（可以不要）

## 4.前景
### 再说